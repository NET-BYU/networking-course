---
layout: homework
title: Network Layer
chapter: 4
icon: network-layer.svg
problems:
    - question: Did you do spend at least 30 minutes on the [IP](http://www-net.cs.umass.edu/wireshark-labs/Wireshark_IP_v8.0.pdf) Wireshark lab?
    - question: Consider a datagram network using 8-bit host addresses. Suppose a router uses longest-prefix matching with the above forwarding table. Suppose a datagram arrives at the router, with the following destination addresses. Specify which interface will the datagram be forwarded using longest-prefix matching.
      image: assets/longest_prefix.png
      parts: 
        - "`01110001`"
        - "`10011101`"
        - "`01011011`"

    - question: Consider sending a 2400-byte datagram into a link that has an MTU (maximum transmit unit) of 700 bytes. Suppose the original datagram is stamped with the identification number 422. You might have to look up the [specifics of each field](https://en.wikipedia.org/wiki/IPv4#Header) to answer this question. Remember, the IP header takes up 20 bytes of the MTU.
      parts:
        - How many fragments are generated? 
        - List the (1) identification field, (2) fragment offset field, (3) more fragments flag, and (4) length field for each of the fragments generated.

    - question: Assume you are setting up subnets on your home network, using the address space 192.168.0.0/16. You are trying to make subnets as small as possible but still accommodate the necessary number of hosts. What should the subnet (in CIDER notation) be if you want to support at most 61 hosts?

    - question: Consider the scenario below in which three hosts, with private IP addresses 10.0.1.11, 10.0.1.15, 10.0.1.23 are in a local network behind a NAT'd router that sits between these three hosts and the larger Internet. IP datagrams being sent from, or destined to, these three hosts must pass through this NAT router. The router’s interface on the LAN side has IP address 10.0.1.27, while the router’s address on the Internet side has IP address 135.122.200.215. Suppose that the host with IP address 10.0.1.11 sends an IP datagram destined to host 128.119.175.183. The source port is 3415, and the destination port is 80.
      image: assets/nat.png
      parts: 
        - What is the source IP address, source port, destination address, and destination port for datagram 1?
        - What is the source IP address, source port, destination address, and destination port for datagram 2?
        - What is the source IP address, source port, destination address, and destination port for datagram 3?
        - What is the source IP address, source port, destination address, and destination port for datagram 4?

    - question: Suppose you are interested in detecting the number of hosts behind a NAT. You observe that the IP layer stamps an identification number sequentially on each IP packet. The identification number of the first IP packet generated by a host is a random number, and the identification numbers of the subsequent IP packets are sequentially assigned. Assume all IP packets generated by hosts behind the NAT are sent to the outside world.
      parts:
        - Based on this observation, and assuming you can sniff all packets sent by the NAT to the outside, can you outline a simple technique that detects the number of unique hosts behind a NAT? Justify your answer.
        - If the identification numbers are not sequentially assigned but randomly assigned, would your technique work? Justify your answer.

    - question: In this problem we'll explore the impact of NATs on P2P applications. Suppose a peer with username Arnold discovers through querying that a peer with username Bernard has a file it wants to download. Also suppose that Bernard and Arnold are both behind different NATs. Try to devise a technique that will allow Arnold to establish a TCP connection with Bernard without application-specific NAT configuration (e.g., logging into a router and setting up port forwarding). If you have difficulty devising such a technique, discuss why.
---

